#!/usr/bin/env nextflow

params {
    // General
    outdir = './results'

    modules {
        'cutadapt' {
            args             = "-a CTGTCTCTTATA"
            suffix           = ".trimmed"
            publish_dir      = "scRNAseq_alignment/cutadapt"
            publish_results  = "none"
        }
        'samtools_sort' {
            args             = ""
            suffix           = ".bam"
            publish_dir      = "scRNAseq_alignment/samtools_sort"
            publish_results  = "none"
        }
        'samtools_view_a' {
            args             = "-b -h"
            suffix           = ".bam"
            publish_dir      = "scRNAseq_alignment/samtools_view_a"
            publish_results  = "none"

        }
        'samtools_view_b' {
            args             = "-b -h -F 4 -q 10"
            suffix           = ".filtered.bam"
            publish_dir      = "scRNAseq_alignment/samtools_view_b"
            publish_results  = "none"
        }
        'hisat2_splice_align' {
            args             = "--phred33 --dta-cufflinks"
            suffix           = ".aligned"
            publish_dir      = "scRNAseq_alignment/hisat2"
            publish_results  = "none"
        }
        'hisat2_align' {
            args             = "--phred33 --dta-cufflinks"
            suffix           = ".aligned"
            publish_dir      = "scRNAseq_alignment/hisat2"
            publish_results  = "none"
        }
        'bedtools_intersect' {
            args             = "-wa"
            suffix           = "+H3K27Ac_intersected.bed"
            publish_dir      = "enhancer_analysis/bedtools_intersect"
            publish_results  = "all"
        }
        'bedtools_subtract' {
            args             = "-A"
            suffix           = "-H3K27me3_subtracted.bed"
            publish_dir      = "enhancer_analysis/bedtools_subtract"
            publish_results  = "all"
        }
        'homer_annotate_peaks' {
            args             = "-gid"
            suffix           = ".annotated.txt"
            publish_dir      = "enhancer_analysis/homer"
            publish_results  = "all"
        }
        'homer_find_motifs' {
            args             = "-size 100"
            publish_dir      = "enhancer_analysis/homer_find_motifs"
            publish_results  = "all"
        }
        'awk' {
            args             = /-F "\t" 'BEGIN{OFS="\t";} ($10 <0) || ($10 >2000) && ($8!~\/^exon.\/) {print $0}'/
            outfile_name     = "putative_enhancers_annotated.txt"
            publish_dir      = "enhancer_analysis/putative_enhancers"
            publish_results  = "all"
        }
        'cut' {
            args             = /-f2-4/
            outfile_name     = "putative_enhancers.bed"
            publish_dir      = "enhancer_analysis/putative_enhancers"
            publish_results  = "all"
        }
        'add_genome_gfp' {
            publish_dir      = "add_genome_gfp"
            publish_results  = "all"
        }
        'add_gtf_gfp' {
            publish_dir      = "add_gtf_gfp"
            publish_results  = "all"
            strand           = "-"
        }
        'extract_gtf_annotations' {
            publish_dir      = "extract_gtf_annotations"
            publish_results  = "all"
        }
        'lmx1a_dea' {
            publish_dir      = "lmx1a_dea"
            publish_results  = "all"
            script           = "$baseDir/bin/lmx1a_dea.R"
        }
        'sox8_dea' {
            publish_dir      = "sox8_dea"
            publish_results  = "all"
            script           = "$baseDir/bin/sox8_dea.R"
        }
        'merge_counts' {
            publish_dir      = "scRNAseq_alignment/merged_counts"
            publish_results  = "all"
            script           = "$baseDir/bin/merge_counts.R"
        }
        'enhancer_profile' {
            publish_dir      = "enhancer_analysis/enhancer_profile"
            publish_results  = "all"
            script           = "$baseDir/bin/enhancer_profile.R"
        }
        'merge_smartseq_bulk' {
            publish_dir      = "merge_smartseq_bulk"
            publish_results  = "all"
            script           = "$baseDir/bin/merge_smartseq_bulk.R"
        }
        'plot_motifs' {
            publish_dir      = "enhancer_analysis/plot_motifs"
            publish_results  = "all"
            script           = "$baseDir/bin/plot_motifs.R"
        }
        'functional_enrichment_analysis' {
            publish_dir      = "enhancer_analysis/functional_enrichment_analysis"
            publish_results  = "all"
            script           = "$baseDir/bin/functional_enrichment_analysis.R"
        }
    }
}